<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout/base-admin}">
<head>
    <style>
        #table-cs {
            max-height: 200px;
            overflow-y: scroll;
        }
    </style>
</head>
<div layout:fragment="content-admin" class="container my-3">
    <div class="row">
        <div class="col-12">
            <h4>RoomMake Dashboard</h4>
            <div class="text-end"><p>2024년 4월 10일 기준</p></div>
            <hr>
            <!-- 주문배송 클레임 영역 -->
            <div class="row mb-3">
                <div class="col-3">
                    <h6><i class="bi bi-truck"></i> 주문/배송</h6>
                    <table class="table border table-bordered">
                        <tbody>
                        <tr>
                            <th>결제완료</th>
                            <td>1 건</td>
                        </tr>
                        <tr>
                            <th>배송준비중</th>
                            <td>1 건</td>
                        </tr>
                        <tr>
                            <th>배송중</th>
                            <td>1 건</td>
                        </tr>
                        <tr>
                            <th>배송완료</th>
                            <td>1 건</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col-3">
                    <h6><i class="bi bi-clipboard2-check-fill">주문 변동사항</i></h6>

                    <table class="table border table-bordered">
                        <tbody>
                        <tr>
                            <th>구매확정</th>
                            <td>1 건</td>
                        </tr>
                        <tr>
                            <th>취소요청</th>
                            <td>1 건</td>
                        </tr>
                        <tr>
                            <th>반품요청</th>
                            <td>1 건</td>
                        </tr>
                        <tr>
                            <th>교환요청</th>
                            <td>1 건</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col-6">
                    <div id="chart_div"></div>
                </div>
            </div>
            <hr>
            <!-- 매출 역역 -->
            <div class="row mb-3">
                <div class="col-4">
                    <h6><i class="bi bi-graph-up"></i> 매출</h6>
                    <table class="table table-bordered">
                        <colgroup>
                            <col style="width: 40%">
                            <col style="width: 20%">
                            <col style="width: 40%">
                        </colgroup>
                        <thead>
                        <tr>
                            <th>매출일자</th>
                            <th>매출건수</th>
                            <th>매출액(원)</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="salesData : ${salesDataList}">
                            <th th:text="${#dates.format(salesData.date, 'yyyy-MM-dd')}">4월 1일</th>
                            <td th:text="${salesData.salesCnt}">10 건</td>
                            <th th:text="${#numbers.formatInteger(salesData.salesAmount, 3, 'COMMA')}"> 3,000,000</th>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div class="col-8">
                    <div id="curve_chart"></div>
                </div>
                <p>*매출건수는 취소 상태 제외, 매출금액은 실 결제금액 기준입니다. 지난 7일간 발생한 매출에 대해 출력합니다.</p>
            </div>
            <hr>
            <div class="row">
                <div id="mixed_div" style="width: 900px; height: 500px;"></div>
            </div>
            <!-- CS 관련 영역 -->
            <div class="row mb-3">
                <div class="col-6">
                    <h6><i class="fa-solid fa-land-mine-on"></i> 미처리 신고 내역</h6>
                    <table class="table table-bordered">
                        <thead>
                        <tr>
                            <th>신고번호</th>
                            <th>신고내용</th>
                            <th>신고일자</th>
                        </tr>
                        <tr>
                            <th>44362</th>
                            <td>도배</td>
                            <td>2024년 4월 10일</td>
                        </tr>
                        <tr>
                            <th>26466</th>
                            <td>광고</td>
                            <td>2024년 4월 10일</td>
                        </tr>
                        </thead>
                    </table>
                    <div class="text-end">
                        <a class="btn btn-secondary btn-sm" th:href="@{/admin/management/complaint}">신고 내역</a>
                    </div>
                </div>
                <div class="col-6">
                    <h6><i class="fa-solid fa-triangle-exclamation"></i> 미응답 CS 문의 </h6>
                    <div id="table-cs">
                        <table class="table table-bordered">
                            <thead>
                            <tr style="position: sticky; top: 0; z-index: 1; border-top: 1px">
                                <th>카테고리</th>
                                <th>제목</th>
                                <th>작성자</th>
                                <th>작성일자</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:if="${noAnswerQnas.isEmpty()}">
                                <td class="text-center" style="font-weight: bold" colspan="4">문의사항이 없습니다.</td>
                            </tr>
                            <tr th:each="qna : ${noAnswerQnas}">
                                <th th:text="${qna.category.name}">배송</th>
                                <td th:text="${qna.title}">배송 언제 됨</td>
                                <td th:text="${qna.user.nickname}">강감찬</td>
                                <td th:text="${#dates.format(qna.createDate,'yyyy-MM-dd')}">2024년 4월 5일</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="text-end">
                        <a class="btn btn-secondary btn-sm" th:href="@{/admin/management/qna}">문의 내역</a>
                    </div>
                </div>
            </div>
            <hr>
            <!-- 방문자 및 신규가입 영역 -->
            <div class="row mb-3">
                <div class="col-6">
                    <h6><i class="bi bi-people"></i> 고객현황</h6>
                    <table class="table table-bordered">
                        <thead>
                        <tr>
                            <th>구분</th>
                            <th>신규가입</th>
                            <th>방문자</th>
                        </tr>
                        <tr>
                            <th>전일 신규</th>
                            <td><span th:text="${newUserCnt}"></span>명</td>
                            <td>명</td>
                        </tr>
                        <tr>
                            <th>누적</th>
                            <td><span th:text="${totalUserCnt}"></span>명</td>
                            <td> 명</td>
                        </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript" layout:fragment="script">
    // 원형 차트
    var data;
    var chart;

    function drawChart() {

        // Create our data table.
        data = new google.visualization.DataTable();
        data.addColumn('string', 'Topping');
        data.addColumn('number', 'Slices');
        data.addRows([
            ['Mushrooms', 3],
            ['Onions', 1],
            ['Olives', 1],
            ['Zucchini', 1],
            ['Pepperoni', 2]
        ]);

        var options = {
            'title': 'How Much Pizza I Ate Last Night',
            'width': '100%',
            'height': '100%'
        };

        chart = new google.visualization.PieChart(document.getElementById('chart_div'));
        google.visualization.events.addOneTimeListener(chart, 'select', selectHandler);
        chart.draw(data, options);
    }

    function selectHandler() {
        var selectedItem = chart.getSelection()[0];
        var value = data.getValue(selectedItem.row, 0);
        alert('The user selected ' + value);
    }

    // 라인차트
    function drawLineChart() {
        var data = google.visualization.arrayToDataTable([
            ['Year', 'Sales', 'Expenses'],
            ['2004', 1000, 400],
            ['2005', 1170, 460],
            ['2006', 660, 1120],
            ['2007', 1030, 540]
        ]);

        var options = {
            title: 'Company Performance',
            curveType: 'none',
            legend: {position: 'bottom'}
        };

        var chart = new google.visualization.LineChart(document.getElementById('curve_chart'));

        chart.draw(data, options);
    }

    function drawVisualization() {
        // Some raw data (not necessarily accurate)
        var data = google.visualization.arrayToDataTable([
            ['Month', 'Bolivia', 'Ecuador', 'Madagascar', 'Papua New Guinea', 'Rwanda', 'Average'],
            ['2004/05', 165, 938, 522, 998, 450, 614.6],
            ['2005/06', 135, 1120, 599, 1268, 288, 682],
            ['2006/07', 157, 1167, 587, 807, 397, 623],
            ['2007/08', 139, 1110, 615, 968, 215, 609.4],
            ['2008/09', 136, 691, 629, 1026, 366, 569.6]
        ]);

        var options = {
            title: 'Monthly Coffee Production by Country',
            vAxis: {title: 'Cups'},
            hAxis: {title: 'Month'},
            seriesType: 'bars',
            series: {5: {type: 'line'}}
        };

        var chart = new google.visualization.ComboChart(document.getElementById('mixed_div'));
        chart.draw(data, options);
    }


</script>
</html>