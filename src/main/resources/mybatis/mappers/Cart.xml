<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.roommake.cart.mapper.CartMapper">

    <select id="getCartsByUserId" parameterType="int" resultType="com.roommake.cart.dto.CartItemDto">
        select
            c.cart_id               as cartId,
            c.cart_item_count       as count,
            p.product_id            as productId,
            p.product_name          as name,
            p.product_price         as price,
            p.product_discount      as discount,
            p.parents_product_id    as parentsProductId,
            pd.product_detail_id    as productDetailId,
            pd.product_detail_size  as size,
            pd.product_detail_color as color,
            pd.product_detail_stock as stock
        from
            cart c join product p join product_detail pd
        on
            c.product_id = p.product_id
        and c.product_detail_id = pd.product_detail_id
        and c.user_id = #{userId}
    </select>

</mapper>